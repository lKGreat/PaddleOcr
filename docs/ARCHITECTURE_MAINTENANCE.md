# 项目架构维护文档

- 最近更新：2026-02-07
- 维护人：项目维护团队

## 1. 总纲任务（架构层）
- 构建可工程化、可集成、可扩展的 PaddleOCR .NET 工具链。
- 打通 `train -> export -> infer -> service client` 全链路。
- 形成统一 CLI 交互、配置覆盖规则、错误语义和输出结构标准。
- 建立可持续演进的模块边界和回归测试基线。

## 2. 当前架构分层
- `PaddleOcr.Tools`：CLI 入口与命令路由。
- `PaddleOcr.Config`：配置加载、解析和覆盖。
- `PaddleOcr.Inference`：推理执行与后处理。
- `PaddleOcr.Training`：训练流程相关执行器。
- `PaddleOcr.Export`：模型导出能力。
- `PaddleOcr.Data`：数据准备与数据流程。
- `PaddleOcr.ServiceClient`：服务端联调客户端。
- `PaddleOcr.Core`：共享契约、错误定义。
- `PaddleOcr.Models`：共享模型与领域类型。

## 3. 已完成项（基于当前仓库）
- 完成基础模块拆分，形成按职责分离的 `src/*` 结构。
- 建立统一解决方案 `PaddleOcr.slnx`，支持统一构建。
- 提供 CLI 工程入口，具备本地命令运行方式。
- 建立测试工程 `tests/PaddleOcr.Tests`，具备单测执行链路。
- 建立 `assets/` 与 `scripts/sync-assets.ps1` 的资产维护基础。
- 在 `docs/` 中已有业务方向与技术路线基线文档。

## 4. 未完成项（需持续推进）
- 明确并固化各模块对外契约（输入、输出、错误码）。
- 完成全链路端到端验证基线（训练到推理的可重复样例）。
- 建立推理性能基线和质量基线（延迟、吞吐、准确度）。
- 补齐核心场景自动化回归测试覆盖率。
- 统一输出结构标准，方便业务系统消费与追踪。
- 完善可观测能力（关键日志、耗时、失败分类）。

## 5. 可闭环实施计划（架构）

### 闭环 A：CLI 与配置标准化
- 目标：保证核心命令可稳定执行，配置可预测覆盖。
- 任务：
  - 梳理并文档化核心命令参数矩阵。
  - 固化 `-c` 与 `-o` 覆盖优先级规则并增加测试。
  - 统一参数错误与配置错误的异常语义。
- 完成定义（DoD）：
  - 核心命令具备标准样例并可一键运行。
  - 配置覆盖规则有文档、有测试、有示例。
  - 错误场景可通过测试稳定复现。
- 状态：进行中。

### 闭环 B：推理链路稳定性与结果标准化
- 目标：让 `infer` 在标准输入上稳定、可追踪、可集成。
- 任务：
  - 统一推理结果结构（文本、框、分数、元信息）。
  - 增加失败分类与关键日志字段。
  - 建立标准样例集并加入回归测试。
- 完成定义（DoD）：
  - 输出结构文档化并在样例中验证。
  - 失败日志可定位到配置/模型/输入问题。
  - 样例回归测试在 CI 或本地稳定通过。
- 状态：未开始。

### 闭环 C：训练-导出-推理贯通
- 目标：形成可复用的端到端工程链路。
- 任务：
  - 定义训练产物到导出产物的契约清单。
  - 建立最小可运行 E2E 流程与脚本。
  - 对 E2E 关键节点添加校验与失败回滚策略。
- 完成定义（DoD）：
  - 一条标准 E2E 流程可按文档重复执行。
  - 关键产物（模型、配置、字典）版本可追踪。
  - E2E 失败可快速定位到具体阶段。
- 状态：未开始。

## 6. 维护机制
- 更新节奏：每个迭代至少更新一次状态。
- 更新要求：每次更新必须写明“新增任务、已完成、阻塞项、下一步”。
- 责任建议：按模块 owner 维护，评审人校验闭环完整性。
